'''
Нам дают гладкое простое число N(имеет много простых делителей):
sage: factor(9613891969102016680606009911539950261406501106149973234767317876223843868064667169046868060331109037214527558145361189875432601771872281799060165442708487-1)
2 * 47 * 89 * 947 * 967 * 1459 * 1567 * 1861 * 1879 * 2011 * 2221 * 2243 * 2689 * 2861 * 3371 * 3583 * 5077 * 5179 * 5437 * 5807 * 5813 * 6871 * 7211 * 7547 * 93443481040117960232640848270740136092809058421573966968734410592855239134661
И комплексные числа a,b такие что
b = a^x mod N
Тут mod N работает как Z/Zp для мнимой и реальной части по отдельности.
Найти нас просят этот x.

Вспомним формулу Муавра
a = |a|*e^(i*teta) 
b = a^x = |a|^x * e^(i*teta*x)
x = log(b,a) = log(|a|^x * e^(i*teta*x), |a|*e^(i*teta) ) = log(|a|^x, |a| )
Таким образом мы нашли изоморфизм C/nC -> Fp, при помощи которого нам остается только решить dlog в GF(N), а это уже довольно известная проблема.
Нам может помешать лишь большой делитель N-1: q=93443481040117960232640848270740136092809058421573966968734410592855239134661, это можно решить, использовав полига-хеллмана.
'''
from sage.all import *
proof.arithmetic(False)
N = 9613891969102016680606009911539950261406501106149973234767317876223843868064667169046868060331109037214527558145361189875432601771872281799060165442708487
a = (1857877518019856658024788108329290634339552460747608605301064601621573902014083582598804765714454271777590941697032729074429780500649068884434864229248280,7531554296519296707862888879832633842252001273381963161587357650438852739942774348223566966373915351984233797158597903240533333792006040195809812498419767)
b = (1533855055814415883193373270777786617614010634672629358042622770362732046116363897855933678085424367919674219872606015152328968223604048122991167064191670, 1527207996322996079682249844900237849466793617905561252322085015761295575124522067417852682582975392725384739028007783440607716576291747497690880246755325)


F = GF(N)
a_r = F(a[0]**2 + a[1]**2)
b_r = F(b[0]**2 + b[1]**2)
q = 93443481040117960232640848270740136092809058421573966968734410592855239134661
flag = discrete_log(b_r^q,a_r^q,ord=(N-1)/q) # 214557755260953269992172544166246986605038116639982954406591849545674992952
