# CryptoJail

### Сложность

Hard

### Информация

```
Однажды цифровой ковбой, известный своим бесстрашием и любовью к приключениям, решил побродить по просторам web3. Однако, во время своих странствий он попал в ловушку и оказался заперт в криптотюрьме - высокотехнологичной тюрьме, созданной злодеем-хакером, известным как "Мастер Ключей". Теперь вам предстоит помочь цифровому ковбою выбраться из криптотюрьмы.
```

### Описание

Контракт в сети TON Blockchain, у которого надо подобрать ключ от 1 до 500. В случае неправильного подбора ключа, токены возвращаются. Ключ с каждым успешным подбором меняется. После того как участник находит ключ, создателю контракта приходит сообщение об этом, после чего создатель отправляет зашифрованное сообщение на кошелек участника. К сожалению не получится автоматизировать процесс отправки зашифрованных сообщений...

### Запуск
```
cd deploy
npm add
npx blueprint build
npx blueprint run
```

1. Build

`npx blueprint build` or `yarn blueprint build`

2. Test

`npx blueprint test` or `yarn blueprint test`

3. Update snapshots

`npm test -- -u`

4. Deploy or run another script

`npx blueprint run` or `yarn blueprint run`

### Возможные проблемы с запуском

- `@tact-lang/compiler` - need to clone the [tact-lang/tact](https://github.com/tact-lang/tact), build it manually and copy-paste dist folder to node_modules

### Выдать учаcтникам

- `task_contract.tact`  - исходный код контракта
- `EQAvQ_0a_v12p73XbBCwHDmKlqj4FNNIVw5X0GvQgfhckoZq` - адрес контракта

### Решение

Первым делом нужно создать кошелек в тестовой сети: Tonkeeper или MyTonWallet. Затем в настройках внизу нужно покликать на версию приложения, после чего откроется выбор сети. Затем нужно получить тестовые токены на этот коешелек с помощью [testgiver_ton_bot](https://t.me/testgiver_ton_bot).

Перебираем значения от 1 по 500 и посылаем запрос на контракт. Пример одного запроса можно увидеть в `checkKeyTaskContract.ts`. 
Для самого брута участнику нужно либо задеплоить highload_wallet_v2 и отправлять несколько запросов за раз (можно с помощью TonDevWallet), либо написать для этого контракт (так как отправка флага участникам произовдится вручную, то в данном случае флаг можно отправить не на адрес контракта, а сразу участнику). 

### Флаг

GOCTF{Br34k1ng_th3_Bl0ckch41n_j41l}
